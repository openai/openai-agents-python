---
search:
  exclude: true
---
# 멀티 에이전트 오케스트레이션

오케스트레이션은 앱에서 에이전트가 동작하는 흐름을 의미합니다. 어떤 에이전트를 어떤 순서로 실행하고, 다음에 무엇을 할지 어떻게 결정할까요? 에이전트를 오케스트레이션하는 주요 방법은 두 가지입니다:

1. LLM 이 결정을 내리도록 허용하기: LLM 의 지능을 활용해 계획하고 추론하며 그에 따라 수행할 단계를 결정하는 방식
2. 코드로 오케스트레이션하기: 코드로 에이전트의 흐름을 결정하는 방식

이 패턴들을 혼합해 사용할 수 있으며, 각각의 절충점은 아래에 설명되어 있습니다.

## LLM 을 통한 오케스트레이션

에이전트는 instructions, tools, 핸드오프 를 갖춘 LLM 입니다. 이는 개방형 과제가 주어졌을 때 LLM 이 도구를 사용해 행동하고 데이터를 수집하며, 핸드오프 를 통해 하위 에이전트에 작업을 위임하는 방식으로 과제를 해결하는 계획을 자율적으로 수립할 수 있음을 의미합니다. 예를 들어, 리서치 에이전트는 다음과 같은 도구를 갖출 수 있습니다:

- 웹 검색 을 통해 온라인에서 정보 찾기
- 파일 검색 및 검색으로 사내 데이터와 연결을 탐색하기
- 컴퓨터 사용 으로 컴퓨터에서 작업 수행하기
- 코드 실행 으로 데이터 분석 수행하기
- 기획, 보고서 작성 등에 특화된 에이전트로의 핸드오프

이 패턴은 과제가 개방형이고 LLM 의 지능에 의존하고자 할 때 적합합니다. 여기서 가장 중요한 전술은 다음과 같습니다:

1. 좋은 프롬프트에 투자하세요. 사용 가능한 도구, 사용 방법, 그리고 반드시 준수해야 하는 매개변수 를 명확히 하세요.
2. 앱을 모니터링하고 반복 개선하세요. 어디에서 문제가 생기는지 파악하고 프롬프트를 개선하세요.
3. 에이전트가 자기 성찰하고 개선하도록 허용하세요. 예를 들어 루프에서 실행하여 스스로 비판하게 하거나, 오류 메시지를 제공하고 이를 통해 개선하도록 하세요.
4. 다목적 에이전트 하나에 모든 것을 기대하기보다, 하나의 작업에 특화되어 뛰어난 성능을 내는 전문 에이전트를 두세요.
5. [evals](https://platform.openai.com/docs/guides/evals)에 투자하세요. 이를 통해 에이전트를 훈련하여 과제 수행 능력을 향상시킬 수 있습니다.

## 코드 기반 오케스트레이션

LLM 기반 오케스트레이션이 강력하긴 하지만, 코드 기반 오케스트레이션은 속도, 비용, 성능 측면에서 더 결정적이고 예측 가능하게 만듭니다. 일반적인 패턴은 다음과 같습니다:

- [structured outputs](https://platform.openai.com/docs/guides/structured-outputs)를 사용하여 코드로 검사할 수 있는 적절한 형식의 데이터 를 생성하기. 예를 들어, 에이전트에게 작업을 몇 개의 카테고리 로 분류하도록 요청한 다음, 해당 카테고리에 따라 다음 에이전트를 선택할 수 있습니다.
- 하나의 에이전트 출력을 다음 에이전트의 입력으로 변환하여 여러 에이전트를 체이닝하기. 예컨대 블로그 포스트 작성 작업을 리서치, 개요 작성, 본문 작성, 비판, 개선의 일련의 단계로 분해할 수 있습니다
- 평가 및 피드백을 제공하는 에이전트와 작업을 수행하는 에이전트를 `while` 루프로 함께 실행하여, 평가자가 결과가 특정 기준을 통과했다고 할 때까지 반복하기
- `asyncio.gather` 같은 파이썬 기본 구성요소를 통해 여러 에이전트를 병렬로 실행하기. 서로 의존하지 않는 여러 작업이 있을 때 속도 향상에 유용합니다

[`examples/agent_patterns`](https://github.com/openai/openai-agents-python/tree/main/examples/agent_patterns)에 여러 code examples 가 있습니다.