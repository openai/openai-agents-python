---
search:
  exclude: true
---
# 多智能体编排

编排指的是应用中智能体的流程。哪些智能体运行，以什么顺序运行，它们如何决定接下来发生什么？编排智能体主要有两种方式：

1. 允许LLM做出决策：这使用LLM的智能来计划、推理，并基于此决定采取哪些步骤。
2. 通过代码编排：通过你的代码确定智能体的流程。

你可以混合搭配这些模式。每种方式都有自己的权衡，如下所述。

## 通过LLM编排

智能体是一个配备了指令、工具和交接的LLM。这意味着给定一个开放式任务时，LLM可以自主计划如何解决这个问题，使用工具采取行动和获取数据，并使用交接将任务委托给子智能体。例如，研究智能体可以配备如下工具：

-   网络搜索以在线查找信息
-   文件搜索和检索以搜索专有数据和连接
-   计算机使用以在计算机上执行操作
-   代码执行以进行数据分析
-   交接给专门擅长规划、报告撰写等的专业智能体。

这种模式在任务是开放式且你希望依赖LLM的智能时非常出色。这里最重要的策略是：

1. 投资好的提示。明确说明可用的工具、如何使用它们以及它必须在哪些参数内操作。
2. 监控你的应用并进行迭代。看看哪里出了问题，并对你的提示进行迭代。
3. 允许智能体进行内省和改进。例如，在循环中运行它，让它自我批评；或者提供错误消息并让它改进。
4. 拥有专门擅长一项任务的专业智能体，而不是期望通用智能体擅长任何事情。
5. 投资[评估](https://platform.openai.com/docs/guides/evals)。这让你可以训练你的智能体改进并更好地完成任务。

## 通过代码编排

虽然通过LLM编排很强大，但通过代码编排使任务在速度、成本和性能方面更加确定和可预测。这里的常见模式是：

-   使用[结构化输出](https://platform.openai.com/docs/guides/structured-outputs)生成格式良好的数据，你可以用代码检查这些数据。例如，你可以要求智能体将任务分类为几个类别，然后根据该类别选择下一个智能体。
-   通过将前一个的输出转换为下一个的输入来链接多个智能体。你可以将撰写博客文章之类的任务分解为一系列步骤——进行研究、撰写大纲、撰写博客文章、批评它，然后改进它。
-   在`while`循环中运行执行任务的智能体和提供评估与反馈的智能体，直到评估者说输出通过某些标准。
-   并行运行多个智能体，例如通过Python原语如`asyncio.gather`。当你有多个不相互依赖的任务时，这对于速度很有用。

我们在[`examples/agent_patterns`](https://github.com/openai/openai-agents-python/tree/main/examples/agent_patterns)中有许多示例。